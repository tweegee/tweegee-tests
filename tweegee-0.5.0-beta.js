(()=>{"use strict";var t={n:e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const e=Phaser;var s=t.n(e);class i{constructor(t){this.native=t.native,this.code=t.code,this.flag=t.flag,this.rtl=t.rtl}message(t,...e){return this.dictionary[t]?this.dictionary[t].replace(/\$(\d+)/g,((t,s)=>e[s-1])):"$"+t}static get(t){return this.list[t]||null}static translate(t,e,...s){return i.list[t]?i.list[t].message(e,...s):"$"+e+".@"+t}static load(t,e,s){return i.list[t]||(i.list[t]=new i(Object.assign({code:t},e)),i.list[t].dictionary=s),i.list[t]}}i.list=[];const n=new TextEncoder,r=new TextDecoder("utf-8");class o{constructor(t,e=2){"number"==typeof t?(this.readable=!1,this.allocated=0,this.buffer=new ArrayBuffer(0),this.length=0,this.byteView=new Uint8Array(this.buffer),this.floatView=new Float32Array(1),this.allocate(e,!1),this.write16(t)):(this.readable=!0,this.pointer=0,this.buffer=t instanceof o?t.buffer:t instanceof Uint8Array?t.buffer.slice(0):t,this.length=this.buffer.byteLength,this.byteView=new Uint8Array(this.buffer),this.floatView=new Float32Array(1))}allocate(t,e=!0){this.allocated+=e?t+30:t;const s=this.byteView;this.buffer=new ArrayBuffer(this.allocated),this.byteView=new Uint8Array(this.buffer),this.byteView.set(s)}grow(t){this.length+=t,this.length>this.allocated&&this.allocate(this.length-this.allocated)}write8(t){return this.grow(1),this.byteView[this.length-1]=255&t,this}write16(t){return this.grow(2),this.byteView[this.length-2]=t>>8&255,this.byteView[this.length-1]=255&t,this}write24(t){return this.grow(3),this.byteView[this.length-3]=t>>16&255,this.byteView[this.length-2]=t>>8&255,this.byteView[this.length-1]=255&t,this}write32(t){return this.grow(4),this.byteView[this.length-4]=t>>24&255,this.byteView[this.length-3]=t>>16&255,this.byteView[this.length-2]=t>>8&255,this.byteView[this.length-1]=255&t,this}writeFloat(t){return this.grow(4),this.floatView[0]=t,console.log(new Uint8Array(this.floatView.buffer)),this.byteView.set(new Uint8Array(this.floatView.buffer),this.length-4),this}writeBool(t){return this.write8(t?1:0)}writeBuffer(t){return this.grow(t.length),this.byteView.set(t,this.length-t.length),this}writeRawString(t){return this.writeBuffer(n.encode(t))}writeString(t){const e=this.length+t.length+2;return e>this.allocated&&this.allocate(e-this.allocated),this.write16(t.length),this.byteView.set(n.encode(t),this.length),this.length+=t.length,this}writeBigString(t){const e=this.length+t.length+3;return e>this.allocated&&this.allocate(e-this.allocated),this.write24(t.length),this.byteView.set(n.encode(t),this.length),this.length+=t.length,this}writeLongString(t){const e=this.length+t.length+4;return e>this.allocated&&this.allocate(e-this.allocated),this.write32(t.length),this.byteView.set(n.encode(t),this.length),this.length+=t.length,this}read(t){if(this.pointer+=t,this.pointer>this.length)throw"Reading overflow"}read8(){return this.read(1),this.byteView[this.pointer-1]}read16(){return this.read(2),(this.byteView[this.pointer-2]<<8)+this.byteView[this.pointer-1]}read24(){return this.read(3),(this.byteView[this.pointer-3]<<16)+(this.byteView[this.pointer-2]<<8)+this.byteView[this.pointer-1]}read32(){return this.read(4),(this.byteView[this.pointer-4]<<24)+(this.byteView[this.pointer-3]<<16)+(this.byteView[this.pointer-2]<<8)+this.byteView[this.pointer-1]}readS8(){const t=this.read8();return(128&t)>0?-128|127&t:t}readS16(){const t=this.read16();return(32768&t)>0?-32768|32767&t:t}readS24(){const t=this.read24();return(8388608&t)>0?-8388608|8388607&t:t}readS32(){const t=this.read32();return(2147483648&t)>0?-2147483648|2147483647&t:t}readFloat(){return this.read(4),this.floatView=new Float32Array(this.byteView.slice(this.pointer-4,this.pointer).buffer),this.floatView[0]}readBool(){return 1===this.read8()}readRawString(t){return this.read(t),r.decode(this.byteView.slice(this.pointer-t,this.pointer))}readString(){return this.readRawString(this.read16())}readBigString(){return this.readRawString(this.read24())}readLongString(){return this.readRawString(this.read32())}cipher(t,e,s=null){for(let i=2;i<this.length;++i)this.byteView[i]^=null!==s?e[(i+s-1)%e.length]^t:e[i%e.length]^t;return this}export(t,e,s,i=!1){i&&this.cipher(e,t,s);let n=this.length,r=n>>7,a=[];for(a.push(o.HEADER),a.push(s|(i?1:0)<<7);r;)a.push(127&n|128),n=r,r>>=7;a.push(127&n);const h=new Uint8Array(a.length+this.length+1);return h.set(a,0),this.allocated>this.length?h.set(this.byteView.slice(0,this.length),a.length):h.set(this.byteView,a.length),h[h.length-1]=o.TRAILER,h}available(){return this.length-1-this.pointer}}o.HEADER=84,o.TRAILER=83;class a{constructor(t,e){this.name=t,this.protocol=e,this.listening={}}has(t){return t in this.listening}handle(t,e){const s=this.listening[t];if(s){const i=s.callback||s["onPacket_"+t];i&&"function"==typeof i?(i.bind(s.scope||this,e,s.extra||{})(),(s.once||s.repeat--)&&delete this.listening[t]):console.warn("[Network][%s][%s] Could not find handler of packet (0x%s).",this.protocol.connection.name,this.name,t.toString(16))}}listen(t,e){return this.has(t)||(this.listening[t]=e),this}}class h{constructor(t){this.expecting=0,this.connection=t,this.handlers=[]}addHandler(t){return this.handlers.includes(t)||this.handlers.push(t),this}removeHandler(t){if(t instanceof a){const e=this.handlers.indexOf(t);if(-1!==e)return this.handlers.splice(e,1),this}for(let e=0;e<this.handlers.length;++e)if(this.handlers[e].name===t){this.handlers.splice(e,1);break}return this}onConnectionMade(){console.log("[%cTweegee%c][Network][%s] Connection made successfuly [%s].","color: #5f76d3;","color: none;",this.connection.name,this.connection.socket.url),this.sequenceId=0}onDataReceived(t){const e=new Uint8Array(t);if(e.length<3)return;let s=0,i=e.length-1;const n=e[s++],r=e[i--],a=e[s++];if(n===o.HEADER&&r===o.TRAILER)for(;s<i;){if(!this.expecting){for(let t=0;t<5;++t){if(s===i)return void(this.expecting=0);const n=e[s++];if(this.expecting|=(127&n)<<7*t,!(128&n))break}if(!this.expecting)continue;if(this.expecting<2)break}const n=new o(t.slice(s,i+1));a&&n.cipher(f.xorKey,f.packetKeys),this.listen(n),s+=this.expecting,this.expecting=0}else f.DebugMode&&console.error("[Network][%s][Packet] Invalid header or trailer received (H: %o, T: %o) != (H: %o, T: %o).",this.connection.name,n,r,o.HEADER,o.TRAILER)}onConnectionLost(t){t.wasClean||console.error("[Network][%s] Connection lost due to unexpected error. (Error Code: %s)",this.connection.name,t.code),console.warn("[Network][%s] Connection lost [%s].",this.connection.name,this.connection.socket.url)}listen(t){if(t.available()){const e=t.read16();for(const s in this.handlers){const i=this.handlers[s];if(i.has(e))return void i.handle(e,t)}console.warn("[Network][%s] Received unhandled packet (C: 0x%s).",this.connection.name,e.toString(16).toUpperCase())}}send(t,e=!1,s=!1){if(!this.connection.connected)return this.connection.queue.push({packet:t,crypt:e}),void(s&&this.connection.connect({host:this.connection.host,secured:this.connection.secured}));this.connection.socket.send(t.export(f.packetKeys,f.xorKey,this.sequenceId,e)),this.sequenceId=(this.sequenceId+1)%128}}class l{constructor(t){this.queue=[],this.secured=!1,this.name=t,this.protocol=new h(this)}get connected(){var t;return(null===(t=this.socket)||void 0===t?void 0:t.readyState)===WebSocket.OPEN}connect(t){if(this.connected&&(t.forceDisconnect?(this.socket.close(),console.log("[%cTweegee%c][%s] %cLast connection forced to close due to open another connection instance.","color: #5f76d3;","color: none;",this.name,"color: red")):console.log("[%cTweegee%c][%s] Another instance is already connected in this connection.","color: #5f76d3;","color: none;",this.name)),t.host)return this.host=t.host,t.port&&(this.host+=":"+t.port),this.secured=!!t.secured,this.events=t.events,this.socket=new WebSocket((this.secured?"wss://":"ws://")+this.host),this.socket.binaryType="arraybuffer",this.socket.onopen=()=>{var e;this.protocol.onConnectionMade(),null===(e=t.events)||void 0===e||e.onconnect()},this.socket.onclose=e=>{var s;this.protocol.onConnectionLost(e),null===(s=null==t?void 0:t.events)||void 0===s||s.ondisconnect()},this.socket.onmessage=t=>{this.protocol.onDataReceived(t.data)},this;console.error("[Tweegee][%s] Cannot connect to an undefined host.",this.name)}}const c=4101,d=4097;var u,g;!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.INVALID_DETAILS=1]="INVALID_DETAILS",t[t.ALREADY_CONNECTED=2]="ALREADY_CONNECTED"}(u||(u={})),function(t){t[t.SUCCESS=0]="SUCCESS",t[t.USERNAME_EXCEED_LENGTH=1]="USERNAME_EXCEED_LENGTH",t[t.NICKNAME_EXCEED_LENGTH=2]="NICKNAME_EXCEED_LENGTH",t[t.INVALID_USERNAME_FORMAT=3]="INVALID_USERNAME_FORMAT",t[t.INVALID_NICKNAME_FORMAT=4]="INVALID_NICKNAME_FORMAT",t[t.INVALID_EMAIL=5]="INVALID_EMAIL",t[t.PASSWORD_EXCEED_LENGTH=6]="PASSWORD_EXCEED_LENGTH",t[t.INVALID_CONFIRM_PASSWORD=7]="INVALID_CONFIRM_PASSWORD",t[t.INVALID_GENDER=8]="INVALID_GENDER"}(g||(g={}));class p extends a{constructor(t){var e;super("System",t),this.listen(d,{callback:null===(e=b.instance)||void 0===e?void 0:e.onHandshake,scope:b.instance,once:!0})}}class b{constructor(t){b.instance=this,this.game=t,this.main=new l("Main"),this.main.protocol.addHandler(new p(this.main.protocol))}onHandshake(t){this.pid=1,b.isBeta=!0,this.game.scene.stop("PreloadScene"),this.game.scene.start("LoginScene",{tweegee:this,playersCount:0}),console.info("[%cTweegee%c] Player (PID) = %o","color:#ff8a65","color:none",this.pid),console.info("[%cTweegee%c] There are %o players online on this community %o","color:#ff8a65","color:none",0,i.current.code),console.info("[%cTweegee%c] Beta mode: %c%s","color:#ff8a65","color:none",b.isBeta?"color:cyan":"color:red",b.isBeta?"ON":"OFF"),console.info("[%cTweegee%c] Debug mode: %c%s","color:#ff8a65","color:none",f.DebugMode?"color:cyan":"color:red",f.DebugMode?"ON":"OFF")}}b.discordLink="https://discord.gg/gYesKre6tq";const f={__CLIENT_VERSION:"0.5.0-beta",__XOR_KEY:"87146",__PACKET_KEYS:"90,229,16,45,199,126,5,243,138,35,24,58,97,206,151,250",__CONNECTION_KEY:"npnjr0",Server:{Dev:"127.0.0.1:1771",Prod:"127.0.0.1:1771"},get xorKey(){return+f.__XOR_KEY},get packetKeys(){return f.__PACKET_KEYS.split(",").map((t=>parseInt(t)))},get connectionKey(){return f.__CONNECTION_KEY},get clientVersion(){return f.__CLIENT_VERSION},DebugMode:!0,LocalServer:!0,DiscordURL:"https://discord.gg/gYesKre6tq",WebsiteURL:"https://tweegee.net",AppURL:"https://app.tweegee.net"};class m extends Phaser.Events.EventEmitter{constructor(t,e){super(),this.object=t,this.object.ui=this,this.options=e||{},this.enable(),this.initEvents()}initEvents(){this.object.on("pointerover",(t=>{this.emit("over",t,this)})).on("pointerout",(t=>{this.emit("out",t,this)})).on("pointerdown",(t=>{this.emit("click",t,this)})).on("pointerup",(t=>{this.emit("blur",t,this)}))}toggle(){return this.enabled?this.disable():this.enable()}disable(){return this.enabled=!1,this.object.disableInteractive(),this.object.alpha=.5,this}enable(){return this.enabled=!0,this.object.setInteractive(this.options),this.object.alpha=1,this}}var w,y;!function(t){t[t.NORMAL=0]="NORMAL",t[t.ONE_BUTTON=1]="ONE_BUTTON",t[t.DOUBLE_BUTTON=2]="DOUBLE_BUTTON",t[t.TRIPLE_BUTTON=3]="TRIPLE_BUTTON"}(w||(w={})),function(t){t[t.DISABLE=0]="DISABLE",t[t.DISCONNECT=1]="DISCONNECT",t[t.FORBIDDEN=2]="FORBIDDEN",t[t.OVERTIME=3]="OVERTIME",t[t.THUMBS_UP=4]="THUMBS_UP",t[t.THUMBS_DOWN=5]="THUMBS_DOWN",t[t.LOCKED=6]="LOCKED",t[t.KICKED=7]="KICKED",t[t.ERROR=8]="ERROR",t[t.RAISE_HANDS=9]="RAISE_HANDS",t[t.RAISE_ONE_HAND=10]="RAISE_ONE_HAND",t[t.SECURITY=11]="SECURITY"}(y||(y={}));class E extends Phaser.GameObjects.Container{constructor(t,e,s,n,r,o,a){super(t.scene,e,s),this.text=t.scene.add.text(0,20,n,{color:"#000",fontFamily:"VAG Rounded, TanseekModernProArabic",fontSize:"20px",fontStyle:"bold",rtl:i.current.rtl}).setOrigin(.5,.5);const h=t.scene.add.image(0,0,"dialog","button-holder"),l=t.scene.add.image(0,20,"dialog","button0001");this.button=new m(l,{useHandCursor:!0,pixelPerfect:!0}),this.button.on("over",(t=>{r&&r(),this.button.object.setFrame("button0002")})),this.button.on("out",(t=>{o&&o(),this.button.object.setFrame("button0001")})),this.button.on("click",(t=>{a&&a(),this.button.object.setFrame("button0001")})),this.add([h,this.button.object,this.text]),t.add(this),t.moveTo(this,1)}toggle(t){return t?this.button.object.disableInteractive():this.button.object.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this}}class v extends Phaser.GameObjects.Container{constructor(t,e,s,n={}){if(super(t,e,s),this.fixedX=0,this.fixedY=0,this.toggleAnimation=!1,this.draggable=!1,this.closeable=!1,this.buttons=[],Object.defineProperty(window,"dialog",{value:this}),this.options=n,this.dialogType=n.type||w.NORMAL,n.buttons)for(let t of n.buttons)this.addButton(n.buttonDirection,t);this.sprite=t.add.sprite(0,0,"dialog","dialog0045"),this.icon=t.add.image(0,120,"tweegee-icons","icon1").setScale(.8),n.icon||this.icon.setVisible(!1),this.textContent=t.add.text(-5,50,"",{color:"black",fontStyle:"bold",fontFamily:"VAG Rounded, Droid Arabic Kufi",fontSize:"20px",fixedWidth:400,fixedHeight:260,rtl:(!n.forceLTR||!i.current.rtl)&&i.current.rtl,wordWrap:{width:400,useAdvancedWrap:!0}}).setOrigin(.5,.5);const r=t.add.sprite(i.current.rtl?-220:220,-80,"dialog","close0001");this.close=new m(r,{pixelPerfect:!0,useHandCursor:!0}).on("over",(()=>{r.play("dialog-close")})).on("click",(()=>{this.emit("beforeClose",this),this.toggle(!1,this.toggleAnimation),this.emit("afterClose",this)})),this.closeable||(this.close.disable(),this.close.object.visible=!1),this.add([this.sprite,this.icon,this.textContent,r]),this.interactivity=this.scene.add.rectangle(0,0,this.scene.scale.width,this.scene.scale.height,0,0).setInteractive(),this.add(this.interactivity),this.moveTo(this.interactivity,0),this.fixedX=this.x,this.fixedY=this.y,this.visible=!1,t.add.existing(this)}get text(){return this.textContent.text}setText(t){return this.textContent.setText(t),this}append(t){return this.textContent.setText(this.text+t),this}toggle(t,e){this.toggleAnimation=e,t?(this.visible=!0,e?(this.sprite.play({key:"dialog"}),this.textContent.visible=!1,this.close.object.visible=!1,this.buttons.forEach((t=>{t.y=150,t.visible=!1})),this.sprite.once(Phaser.Animations.Events.ANIMATION_COMPLETE,(()=>{this.buttons.forEach((t=>{t.visible=!0})),this.displayButtonsAnimation(),this.textContent.visible=!0,this.close.object.visible=this.closeable}))):(this.textContent.visible=!0,this.sprite.setFrame("dialog0044"))):e&&this.visible?(this.textContent.visible=!1,this.close.object.visible=!1,this.scene.add.tween({targets:this.buttons,y:100,duration:900,ease:"Bounce.easeOut",onComplete:()=>{this.buttons.forEach((t=>{t.visible=!1})),this.sprite.play({key:"dialog",startFrame:44,yoyo:!0})}}),this.sprite.once(Phaser.Animations.Events.ANIMATION_COMPLETE,(()=>{this.visible=!1}))):this.visible=!1}reset(){this.setDraggable(!1),this.setCloseable(!1),this.setType(w.NORMAL),this.buttons.forEach(((t,e)=>this.removeButton(e))),this.toggle(!1,!1)}setDraggable(t){return t&&!this.draggable?(this.sprite.setInteractive({pixelPerfect:!0}),this.scene.input.setDraggable(this.sprite,!0),this.scene.input.on(Phaser.Input.Events.DRAG,this.onDrag,this),this.scene.input.on(Phaser.Input.Events.DRAG_END,this.onDragEnd,this),this.draggable=!0):!t&&this.draggable&&(this.sprite.removeInteractive(),this.scene.input.setDraggable(this.sprite,!1),this.scene.input.off(Phaser.Input.Events.DRAG,this.onDrag,this),this.scene.input.off(Phaser.Input.Events.DRAG_END,this.onDragEnd,this),this.draggable=!1),this}setIcon(t){return t?(this.icon.setVisible(!0),this.icon.setFrame("icon"+t),this):(this.icon.setVisible(!1),this)}setCloseable(t){return this.closeable=t,this.close.object.visible=t,t?this.close.enable():this.close.disable(),this}setType(t){return this.dialogType=t,this.buttons.length>t&&this.buttons.splice(t,this.buttons.length-t),this}addButton(t,e){var s,i,n;if(this.dialogType===w.NORMAL)return this;const r=this.buttons.length,o="left"===t?150*r-150:150-150*r,a=this.dialogType===w.ONE_BUTTON?1:this.dialogType===w.DOUBLE_BUTTON?2:this.dialogType===w.TRIPLE_BUTTON?3:0;return this.buttons.length<a?(this.buttons.push(new E(this,o,150,e.text,null===(s=e.events)||void 0===s?void 0:s.over,null===(i=e.events)||void 0===i?void 0:i.out,null===(n=e.events)||void 0===n?void 0:n.click)),this.displayButtonsAnimation(),this):this}removeButton(t){return this.buttons[t].destroy(),this.buttons.splice(t,1),this}displayButtonsAnimation(){this.scene.add.tween({targets:this.buttons,y:220,duration:900,ease:"Bounce.easeOut"})}onDrag(t,e,s,i){e===this.sprite&&(this.x=this.fixedX+s,this.y=this.fixedY+i)}onDragEnd(t,e){e===this.sprite&&(this.fixedX=this.x,this.fixedY=this.y)}}class x extends s().GameObjects.Container{constructor(t,e,s){super(t,null!=e?e:0,null!=s?s:0),this.color="#ffffff";const n=t.add.sprite(0,0,"spinner","spinner0001");this.add(n);const r=t.add.sprite(0,0,"spinner","step-spinner0001");this.add(r),this.spinner=n,this.stepper=r,this.spinner.visible=!1,this.stepper.visible=!1,this.stepText=t.add.text(0,0,"",{fontFamily:"TanseekModernProArabic",fontSize:"35px",color:this.color,rtl:i.current.rtl}).setOrigin(.5,.5).setVisible(!1),this.text=t.add.text(0,80,"",{fontFamily:"TanseekModernProArabic",fontSize:"45px",color:this.color,stroke:"#000",strokeThickness:2,rtl:i.current.rtl}).setOrigin(.5,.5).setVisible(!1),this.stepper.setTintFill(parseInt(this.color.substring(1),16)),this.add([this.stepText,this.text]),t.add.existing(this)}setColor(t){return this.color=t,this.text.setColor(t),this.stepText.setColor(t),this.stepper.setTintFill(parseInt(t.substring(1),16)),this}step(t,e,s=""){this.hideSpinner(),this.stepper.visible=!0,this.stepText.visible=!0,s?this.text.setText(s).setVisible(!0):this.text.setText("").setVisible(!1),0!==t||0!==e?(this.stepper.setFrame("step-spinner000"+t),this.stepText.setText(`${t} / ${e}`)):this.stepper.play("step-spinner")}unstep(){this.stepper.visible=!1,this.stepText.visible=!1,this.text.visible=!1}showSpinner(t=""){this.unstep(),this.spinner.visible=!0,this.spinner.play("spinner"),t?this.text.setText(t).setVisible(!0):this.text.setText("").setVisible(!1)}hideSpinner(){this.spinner.stop(),this.spinner.visible=!1,this.text.visible=!1}}class I extends s().Scene{constructor(){super("UserInterface"),I.instance=this}editorCreate(){this.events.emit("scene-awake")}create(){this.dialog=new v(this,600,450,{buttons:[{text:"Hello"}]}),this.spinner=new x(this,600,450),this.editorCreate()}}class T extends s().Scene{constructor(){super("PreloadScene")}editorPreload(){this.load.pack("login-pack","assets/packs/login-pack.json")}editor(){this.add.image(600,450,"preload","preload-bg");const t=this.add.container(-150,525),e=this.add.image(98,0,"preload","cloud-1");t.add(e);const s=this.add.image(0,0,"preload","cloud-2");t.add(s);const i=this.add.container(1320,430),n=this.add.image(98,-1,"preload","cloud-1");n.scaleX=-1,i.add(n);const r=this.add.image(0,0,"preload","cloud-2");r.scaleX=-1,i.add(r),this.clouds_1=t,this.clouds_2=i,this.events.emit("scene-awake")}preload(){this.precreate(),this.editorPreload()}precreate(){this.editor(),this.add.image(600,150,"tweegee-logo-"+i.current.code).setScale(.8,.8),this.add.tween({targets:this.clouds_1,x:{getEnd:function(){return 1350},getStart:function(t,e,s){return s+1}},y:{getEnd:function(){return 430},getStart:function(t,e,s){return s+1}},yoyo:!0,repeat:-1,duration:3e4}),this.add.tween({targets:this.clouds_2,x:{getEnd:function(){return-150},getStart:function(t,e,s){return s+1}},y:{getEnd:function(){return 525},getStart:function(t,e,s){return s+1}},yoyo:!0,repeat:-1,duration:3e4}),Object.defineProperty(window,"cloud1",{value:this.clouds_2}),this.loadingText=this.add.text(600,700,i.current.message("preload.step_1"),{fontFamily:"Dubai",fontSize:"20px",shadow:{color:"#000",blur:8,fill:!0},color:"#ffffff",rtl:i.current.rtl}).setOrigin(.5,.5)}create(){this.loadingText.setText(i.current.message("preload.step_2")),this.connecting()}connecting(){new b(this.game).main.connect({host:f.LocalServer?f.Server.Dev:f.Server.Prod,forceDisconnect:!0,events:{onconnect:()=>{this.loadingText.setText(i.current.message("preload.step_3")),b.instance.onHandshake(null)},ondisconnect:()=>{I.instance.dialog.reset(),I.instance.dialog.setType(w.ONE_BUTTON),I.instance.dialog.setText(i.current.message("connection_failed")).setIcon(1),I.instance.dialog.addButton("left",{text:"Discord",events:{click:()=>{window.open(b.discordLink,"_blank")}}}),I.instance.dialog.toggle(!0,!0),console.log("xd")}}})}}function O(t,e=null,s=window.location.href){t=t.replace(/[[\]]/g,"\\$&");const i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(s);return i&&i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):e}class _ extends Phaser.GameObjects.DOMElement{constructor(t,e,s,i){super(t,e,s,i),this.children=[],this.scene.add.existing(this)}addNativeChild(t){return this.node.appendChild(t),this}removeNativeChild(t){return this.node.removeChild(t),this}addChild(t){if(t instanceof _)return t.parentComponent=this,this.node.appendChild(t.node),this.children.push(t),this;const e=new _(this.scene,t.x,t.y,t.node);return e.parentComponent=this,this.node.appendChild(t.node),this.children.push(e),this}addChildren(t){for(const e of t)this.addChild(e);return this}removeChild(t){let e;return-1!==(e=this.children.indexOf(t))&&(this.node.removeChild(t.node),this.children.splice(e,1)),this}addClass(t){return Array.isArray(t)?this.node.className+=" "+t.join(" "):this.node.className+=" "+t,this.node.className=this.node.className.trim(),this}removeClass(t){if(Array.isArray(t))t.forEach((t=>this.removeClass(t)));else{const e=this.classes.indexOf(t);-1!==e&&this.classes.splice(e,1)}}attr(t,e){return e?(this.node.setAttribute(t,e),e):this.node.getAttribute(t)}removeAttr(t){"string"==typeof t?this.node.removeAttribute(t):t.forEach((t=>this.removeAttr(t)))}get id(){return this.node.id}set id(t){this.node.id=t}get style(){var t;return null===(t=this.node)||void 0===t?void 0:t.style}set style(t){for(const e in t)"string"==typeof e&&(this.style[e]=t[e])}get innerHTML(){return this.node.innerHTML}set innerHTML(t){this.node.innerHTML=t}get classes(){return this.node.className.split(" ")}set classes(t){this.node.className=t.join(" ")}set size(t){void 0!==t.width&&(this.style.width=t.width+(t.unit||"px"),this.style.maxWidth=t.width+(t.unit||"px"),this.style.minWidth=t.width+(t.unit||"px")),void 0!==t.height&&(this.style.height=t.height+(t.unit||"px"),this.style.maxHeight=t.height+(t.unit||"px"),this.style.minHeight=t.height+(t.unit||"px"))}get size(){return{width:+this.style.width.replace(/cm|inch|px|em|rem|v/g,""),height:+this.style.height.replace(/cm|inch|px|em|rem|v/g,"")}}}class S extends _{constructor(t,e,s,i={}){if(super(t,e,s,"input"),this.size={width:i.width||100,height:i.height||50},i.attrs)for(const t in i.attrs)this.attr(t,i.attrs[t]);this.addClass("T_PlainInput")}getValue(){return this.node.value}setValue(t){return this.node.value=t,this}}class C extends s().Scene{constructor(){super("LoadingScene")}precreate(){this.add.image(600,450,"main-bg2"),this.events.emit("scene-awake")}init(t){this.text=t.text}create(){this.precreate(),this.spinner=new x(this,600,450),this.spinner.hideSpinner(),this.spinner.showSpinner(this.text)}static show(t,e){if(!e.scene.isActive("LoadingScene")){e.scene.launch("LoadingScene",{text:t});const i=e.scene.get("LoadingScene");e.events.once(s().Scenes.Events.CREATE,(()=>{i.scene.stop("LoadingScene")})),e.scene.bringToTop("LoadingScene")}}}class A extends Phaser.Scene{constructor(t){super(t)}preload(){C.show("Loading content...",this),this.customPreload()}}class N extends A{constructor(){super("LoginScene"),N.instance=this}customPreload(){this.load.pack("login-pack","assets/packs/login-pack.json")}precreate(){const t=this.add.image(600,450,"main-bg"),e=this.add.text(1190,10,"",{});e.setOrigin(1,0),e.setStyle({fontSize:"15px"}),this.add.image(250,150,"pane").setOrigin(.5,0);const s=this.add.image(700,360,"__DEFAULT");s.setOrigin(0,0),s.visible=!1;const i=this.add.image(650,308,"ad-banner");i.setOrigin(0,0),this.add.image(250,350,"input-text"),this.add.image(250,410,"input-text").scaleX=-1;const n=this.add.image(250,485,"button"),r=this.add.image(250,555,"button");r.scaleX=-1,r.tintTopLeft=14464838,r.tintTopRight=14464838,r.tintBottomLeft=14464838,r.tintBottomRight=14464838;const o=this.add.text(248,552,"",{});o.angle=-3,o.setOrigin(.5,.5),o.text="Join Now!",o.setStyle({color:"#e6ded9ff",fontFamily:"TanseekModernProArabic",fontSize:"30px"});const a=this.add.text(256,480,"",{});a.angle=3,a.setOrigin(.5,.5),a.text="Log in",a.setStyle({color:"#e6ded9ff",fontFamily:"TanseekModernProArabic",fontSize:"33px"}),this.background=t,this.version=e,this.banner=s,this.ad_banner=i,this.loginbtn=n,this.registerbtn=r,this.registerText=o,this.loginText=a,this.events.emit("scene-awake")}init(t){this.tweegee=t.tweegee,(null==t?void 0:t.playersCount)&&(N.playersCount=t.playersCount)}create(){this.precreate(),this.ad_banner.visible=!1,this.loginText.setText(i.current.message("login")),this.registerText.setText(i.current.message("login.join")),this.registerbtn.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.loginbtn.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.initUsername(),this.initPassword(),this.registerbtn.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.registerbtn.scale=.9})),this.registerbtn.on(Phaser.Input.Events.POINTER_OUT,(()=>{this.registerbtn.scale=1})),this.registerbtn.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.scene.stop("LoginScene"),this.scene.start("RegisterScene",{tweegee:this.tweegee})})),this.loginbtn.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.loginbtn.scale=.9})),this.loginbtn.on(Phaser.Input.Events.POINTER_OUT,(()=>{this.loginbtn.scale=1})),this.loginbtn.on(Phaser.Input.Events.POINTER_DOWN,this.login,this),this.version.setText(f.clientVersion),this.add.image(250,80,"tweegee-logo-"+i.current.code).setScale(.5,.5),this.add.text(145,286,"🟢  "+N.playersCount,{fontSize:"15px",fontFamily:"VAG Rounded",fixedHeight:30,color:"#000",fixedWidth:210,align:"left"}).setOrigin(0,0)}initUsername(){this.usernameInput=new S(this,240,340,{width:190,height:36,attrs:{placeholder:i.current.message("login.username"),spellcheck:"false",autocomplete:"no",minlength:3,maxlength:21,required:"true"}}).setOrigin(.5,.5).addClass("TI_Login"),this.usernameInput.style.direction=i.current.rtl?"rtl":"ltr",this.usernameInput.node.addEventListener("input",this.validateUsername)}validateUsername(){const t=this.usernameInput.node,e=this.usernameInput.getValue();e.length<3||e.length>21?t.setCustomValidity(i.current.message("register.username_length_limit")):/^[A-Za-z][A-Za-z0-9-._]*$/.test(e)?t.setCustomValidity(""):t.setCustomValidity(i.current.message("register.invalid_username_format")),t.reportValidity()}initPassword(){this.passwordInput=new S(this,240,400,{width:190,height:36,attrs:{placeholder:i.current.message("login.password"),spellcheck:"false",autocomplete:"no",type:"password",minlength:8,maxlength:32,required:"true"}}).setOrigin(.5,.5).addClass("TI_Login"),this.passwordInput.style.direction=i.current.rtl?"rtl":"ltr",this.passwordInput.node.addEventListener("input",this.validatePassword)}validatePassword(){const t=this.usernameInput.node,e=this.usernameInput.getValue();e.length<3||e.length>21?t.setCustomValidity(i.current.message("register.username_length_limit")):/^[A-Za-z][A-Za-z0-9-._]*$/.test(e)?t.setCustomValidity(""):t.setCustomValidity(i.current.message("register.invalid_username_format")),t.reportValidity()}setBanner(t){const e=t.key;this.loadBanner(e).then((()=>{this.ad_banner.visible=!0,this.banner.visible=!0,this.banner.setTexture("login-banner-"+e),t.redirect?(this.banner.setInteractive({useHandCursor:!0}),this.banner.on(Phaser.Input.Events.POINTER_DOWN,(()=>{window.open(t.redirect,"_target")})),this.banner.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.banner.setTint(16777215,16777215,0,0)})),this.banner.on(Phaser.Input.Events.POINTER_OUT,(()=>{this.banner.clearTint()}))):(this.banner.disableInteractive(),this.banner.removeAllListeners(Phaser.Input.Events.POINTER_DOWN),this.banner.removeAllListeners(Phaser.Input.Events.POINTER_OVER),this.banner.removeAllListeners(Phaser.Input.Events.POINTER_OUT))}))}hideBanner(){this.ad_banner.visible=!1,this.banner.visible=!1,this.banner.disableInteractive(),this.banner.removeAllListeners(Phaser.Input.Events.POINTER_DOWN),this.banner.removeAllListeners(Phaser.Input.Events.POINTER_OVER),this.banner.removeAllListeners(Phaser.Input.Events.POINTER_OUT)}login(){}loadBanner(t){return new Promise(((e,s)=>{if(this.textures.exists("login-banner-"+t))return e();this.load.image("login-banner-"+t,"/assets/images/login/banners/"+t+".png"),this.load.start(),this.load.once(Phaser.Loader.Events.COMPLETE,(()=>{e()}))}))}}N.playersCount=0;class P extends A{constructor(){super("RegisterScene"),this.gender=0}customPreload(){this.load.pack("register-pack","assets/packs/register-pack.json")}precreate(){this.add.image(600,450,"preload","preload-bg");const t=this.add.sprite(600,450,"board","board0029"),e=this.add.container(315,330);e.visible=!1;const s=this.add.image(0,25,"input-text2");s.scaleX=.8,s.scaleY=.8,s.setOrigin(0,0),e.add(s);const i=this.add.text(0,0,"",{});i.text="Username",i.setStyle({color:"#5b2905ff",fontFamily:"TanseekModernProArabic",fontSize:"30px","shadow.offsetX":-1,"shadow.offsetY":-1,"shadow.color":"#bea687ff","shadow.fill":!0}),e.add(i);const n=this.add.image(280,25,"input-text2");n.scaleX=.8,n.scaleY=.8,n.setOrigin(0,0),e.add(n);const r=this.add.text(280,0,"",{});r.text="Nickname",r.setStyle({color:"#5b2905ff",fontFamily:"TanseekModernProArabic",fontSize:"30px","shadow.offsetX":-1,"shadow.offsetY":-1,"shadow.color":"#bea687ff","shadow.fill":!0}),e.add(r);const o=this.add.text(0,80,"",{});o.text="Email Address",o.setStyle({color:"#5b2905ff",fontFamily:"TanseekModernProArabic",fontSize:"30px","shadow.offsetX":-1,"shadow.offsetY":-1,"shadow.color":"#bea687ff","shadow.fill":!0}),e.add(o);const a=this.add.image(0,105,"input-text2");a.scaleX=.8,a.scaleY=.8,a.setOrigin(0,0),e.add(a);const h=this.add.image(280,105,"input-text2");h.scaleX=.8,h.scaleY=.8,h.setOrigin(0,0),e.add(h);const l=this.add.text(280,80,"",{});l.text="Password",l.setStyle({color:"#5b2905ff",fontFamily:"TanseekModernProArabic",fontSize:"30px","shadow.offsetX":-1,"shadow.offsetY":-1,"shadow.color":"#bea687ff","shadow.fill":!0}),e.add(l);const c=this.add.image(280,180,"input-text2");c.scaleX=.8,c.scaleY=.8,c.setOrigin(0,0),e.add(c);const d=this.add.text(280,155,"",{});d.text="Confirm Password",d.setStyle({color:"#5b2905ff",fontFamily:"TanseekModernProArabic",fontSize:"30px","shadow.offsetX":-1,"shadow.offsetY":-1,"shadow.color":"#bea687ff","shadow.fill":!0}),e.add(d),this.add.image(132,653,"stand");const u=this.add.image(126,630,"guest_btn","guest_btn0001"),g=this.add.text(135,632,"",{});g.angle=-15,g.setOrigin(.5,.5),g.text="Back",g.setStyle({fontFamily:"TanseekModernProArabic",fontSize:"50px"});const p=this.add.image(588,762,"button"),b=this.add.text(590,760,"",{});b.setOrigin(.5,.5),b.text="Join now!",b.setStyle({fontFamily:"TanseekModernProArabic",fontSize:"35px"});const f=this.add.image(401,539,"gender","boy");f.scaleX=.5,f.scaleY=.5;const m=this.add.image(500,542,"gender","girl");m.scaleX=.5,m.scaleY=.5;const w=this.add.image(300,679,"beta-input");w.setOrigin(0,0),w.visible=!1,this.board=t,this.container=e,this.usernameLabel=i,this.nicknameLabel=r,this.emailLabel=o,this.passwordLabel=l,this.confirmPasswordLabel=d,this.backButton=u,this.back_text=g,this.registerButton=p,this.joinText=b,this.boy=f,this.girl=m,this.beta_input=w,this.events.emit("scene-awake")}init(t){this.tweegee=t.tweegee}create(){this.precreate(),this.board.play("board"),this.boy.visible=!1,this.girl.visible=!1,this.board.once(Phaser.Animations.Events.ANIMATION_COMPLETE,(()=>{this.container.visible=!0,this.boy.visible=!0,this.girl.visible=!0,this.beta_input.visible=!0,this.initGenders(),this.initUsername(),this.initNickname(),this.initEmail(),this.initPassword(),b.isBeta&&this.initBetaKey()})),this.back_text.setText(i.current.message("register.back")),this.backButton.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.backButton.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.backButton.setFrame("guest_btn0002")})).on(Phaser.Input.Events.POINTER_OUT,(()=>{this.backButton.setFrame("guest_btn0001")})).once(Phaser.Input.Events.POINTER_DOWN,(()=>{this.scene.stop("RegisterScene"),this.scene.start("LoginScene",{tweegee:b.instance})})),this.joinText.setText(i.current.message("login.join")),this.registerButton.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.registerButton.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.registerButton.scale=.9})).on(Phaser.Input.Events.POINTER_OUT,(()=>{this.registerButton.scale=1})).on(Phaser.Input.Events.POINTER_DOWN,this.submit,this)}initGenders(){this.girl.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.boy.setInteractive({useHandCursor:!0,pixelPerfect:!0}),this.girl.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.boy.setTint(5259071),this.girl.setTint(16777215),this.gender=1})),this.boy.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.girl.setTint(5259071),this.boy.setTint(16777215),this.gender=2}))}initUsername(){this.usernameLabel.setText(i.current.message("register.username")),this.usernameInput=new S(this,10,25,{width:240,height:50,attrs:{spellcheck:"off",required:"true",autocomplete:"off",maxlength:21,minlength:3}}).setOrigin(0,0).addClass("TI_Login"),this.usernameInput.style.color="#8bc34a",this.usernameInput.node.addEventListener("input",(()=>{const t=this.usernameInput.node,e=this.usernameInput.getValue().trim();e.length<3||e.length>21?t.setCustomValidity(i.current.message("register.username_length_limit")):/^[A-Za-z][A-Za-z0-9-._]*$/.test(e)?t.setCustomValidity(""):t.setCustomValidity(i.current.message("register.invalid_username_format")),t.reportValidity()})),this.container.add(this.usernameInput)}initNickname(){this.nicknameLabel.setText(i.current.message("register.nickname")),this.nicknameInput=new S(this,290,25,{width:240,height:50,attrs:{spellcheck:"off",required:"true",autocomplete:"off",maxlength:21,minlength:3}}).setOrigin(0,0).addClass("TI_Login"),this.nicknameInput.style.color="#03a9f4",this.nicknameInput.node.addEventListener("input",(()=>{const t=this.usernameInput.node,e=this.usernameInput.getValue().trim();(e.length<3||e.length>21)&&t.setCustomValidity(i.current.message("register.nickname_length_limit"))})),this.container.add(this.nicknameInput)}initEmail(){this.emailLabel.setText(i.current.message("register.email")),this.emailInput=new S(this,10,105,{width:240,height:50,attrs:{type:"email",spellcheck:"off",autocomplete:"off",minlength:6,required:"true"}}).setOrigin(0,0).addClass("TI_Login"),this.emailInput.style.color="#fff",this.emailInput.node.addEventListener("input",(()=>{const t=this.emailInput.node,e=this.emailInput.getValue();-1===e.indexOf("@")||e.length<5||e.length>64?t.setCustomValidity(i.current.message("register.invalid_email_format")):t.setCustomValidity("")})),this.container.add(this.emailInput)}initPassword(){this.passwordLabel.setText(i.current.message("register.password")),this.confirmPasswordLabel.setText(i.current.message("register.confirm_password")),this.passwordInput=new S(this,290,105,{width:240,height:50,attrs:{type:"password",required:"true"}}).setOrigin(0,0).addClass("TI_Login"),this.passwordInput.style.color="#ff9800",this.confirmPasswordInput=new S(this,290,180,{width:240,height:50,attrs:{type:"password",required:"true"}}).setOrigin(0,0).addClass("TI_Login"),this.confirmPasswordInput.style.color="#ff9800",this.passwordInput.node.addEventListener("input",(()=>{const t=this.passwordInput.node,e=this.passwordInput.getValue();e.length<8||e.length>64?t.setCustomValidity(i.current.message("register.password_limits")):t.setCustomValidity("")})),this.confirmPasswordInput.node.addEventListener("input",(()=>{const t=this.confirmPasswordInput.node;this.confirmPasswordInput.getValue()!=this.passwordInput.getValue()?t.setCustomValidity(i.current.message("register.password_not_match")):t.setCustomValidity("")})),this.container.add([this.passwordInput,this.confirmPasswordInput])}initBetaKey(){this.betaInput=new S(this,325,685,{width:540,height:30,attrs:{spellcheck:"off",autocomplete:"off",minlength:23,required:"true",placeholder:"BETA-KEY"}}).setOrigin(0,0).addClass("TI_Login"),this.betaInput.style.color="#fff",this.betaInput.style.textAlign="center",this.betaInput.style.fontSize="32px",this.betaInput.style.textTransform="uppercase",this.add.existing(this.betaInput)}submit(){const t=this.usernameInput.node,e=this.nicknameInput.node,s=this.emailInput.node,i=this.passwordInput.node,n=this.confirmPasswordInput.node,r=this.betaInput.node;if(t.reportValidity()&&e.reportValidity()&&s.reportValidity()&&i.reportValidity()&&n.reportValidity()&&r.reportValidity()){const n=new o(c);n.writeString(t.value),n.writeString(e.value),n.writeString(s.value),n.writeString(i.value),n.writeString(r.value),n.writeString(window.location.href),n.write8(this.gender),this.tweegee.main.protocol.send(n,!0)}}setResultStatus(t,e){this.statusMessage.setText(t),this.statusMessage.setColor(e)}}const[L,R]=[1200,900];class k extends s().Scene{constructor(){super("Boot")}preload(){let t=O("lang","en"),e={};this.initProgressBar(),this.load.json("languages","assets/data/languages/index.json"),this.load.pack("preload-pack","assets/packs/preload-pack.json"),this.load.pack("ui-pack","assets/packs/ui-pack.json"),this.load.once("filecomplete-json-languages",((s,i,n)=>{e=n,t in n||(t="en"),this.load.image({key:"tweegee-logo-"+t,url:"assets/images/logo/tweegee-logo-"+t+".png"});for(const t of Object.keys(n))this.load.json({key:"language-"+t,url:"assets/data/languages/"+t+".json"})})),this.load.on(s().Loader.Events.FILE_COMPLETE,((s,n,r)=>{if(s.startsWith("language-")){const n=s.split("-")[1],o=i.load(n,e[n],r);n===t&&(i.current=o)}}))}initProgressBar(){const t=this.add.graphics().fillStyle(16777215,.6).fillRect(L/2-100,R/2-10,200,20),e=this.add.graphics().fillStyle(3568790,.75).fillRect(L/2-100,R/2-10,0,20),i=this.make.text({x:L/2,y:R/2,text:"0%",style:{font:"20px Arial",color:"#fff"}}).setOrigin(.5,.5);this.load.on(s().Loader.Events.PROGRESS,(t=>{i.setText(Math.floor(100*t)+"%"),e.clear().fillStyle(3568790,.75).fillRect(L/2-100,R/2-10,200*t,20)})),this.load.once(s().Loader.Events.COMPLETE,(()=>{e.destroy(),t.destroy(),i.destroy(),this.load.removeAllListeners(s().Loader.Events.PROGRESS),this.load.removeAllListeners(s().Loader.Events.FILE_COMPLETE)}))}create(){const t=this.add.image(600,450,"tweegee-logo-"+i.current.code),e=this.add.text(600,650,"Coded by Omaraldin",{fontFamily:"Arial"}).setOrigin(.5,.5);if(this.tweens.add({targets:[e,t],ease:"Sine.easeInOut",duration:3e3,delay:2e3,alpha:"0"}),f.DebugMode="1"===O("d","false"),f.DebugMode)return this.scene.stop("Boot"),this.scene.start("PreloadScene"),this.scene.start("UserInterface"),void this.scene.bringToTop("UserInterface");setTimeout((()=>{this.scene.stop("Boot"),this.scene.start("PreloadScene"),this.scene.start("UserInterface"),this.scene.bringToTop("UserInterface")}),5e3)}}window.addEventListener("load",(function(){document.fonts.ready.then((()=>{new(s().Game)({width:L,height:R,parent:document.getElementById("tweegee-game"),type:s().AUTO,fps:{min:15,target:60},dom:{createContainer:!0},title:"Tweegee Worlds",backgroundColor:"#04a6ea",banner:!1,autoFocus:!0,physics:{default:"matter",matter:{debug:!0}},scale:{mode:s().Scale.ScaleModes.FIT,autoCenter:s().Scale.Center.CENTER_BOTH},scene:[k,I,T,N,P,C]}),console.log("%cWARNING","font-size: 2em;font-family: Arial;font-weight: bold;background: red;padding: 2px;color: white"),console.log("%cDO NOT PASTE ANYTHING HERE","text-decoration: underline;font-size: 1.2em;font-family: Arial;font-weight: bold;color: red;background: #242424;padding:2px;border-radius:2px"),console.log("%cPeople who ask you to open this panel and paste or copy something they may want to steal your account details, be careful and don't trust anyone about this.","font-family: Arial;font-size:1.1em;border-bottom: 3px solid red; padding: 5px;margin-bottom: 5px")}))}))})();